{"ast":null,"code":"import _toConsumableArray from \"/home/juan/node_projects/js-client-grpc-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/juan/node_projects/js-client-grpc-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/juan/node_projects/js-client-grpc-web/src/Subastas/JoinSubasta.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { Alert, Box, Button, Container, Grid, TextField, Typography } from '@mui/material';\nimport proto from '../pb/proto_grpc_web_pb';\nimport DataGridSubastaOfertas from '../components/DataGridTable';\nimport Layout from '../components/Layout/Layout';\nimport useToken from '../App/useToken';\nimport jwt_decode from 'jwt-decode';\nimport StepperVertical from '../components/StepperVertical';\nimport moment from 'moment';\n/** My Client gRPC - to Golang gRPC Server */\n\nvar subastaService = new proto.SubastaServiceClient('http://0.0.0.0:8000');\nexport default function JoinSubasta() {\n  var _useParams = useParams(),\n      id = _useParams.id;\n  /** Info Subasta */\n\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      subasta = _useState2[0],\n      setSubasta = _useState2[1];\n  /** Lista de productos en subasta */\n\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      subastaProductos = _useState4[0],\n      setSubastaProductos = _useState4[1];\n  /** Producto actual en Subasta */\n\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      productoEnSubastaActual = _useState6[0],\n      setProductoEnSubastaActual = _useState6[1];\n  /** Producto subasta */\n\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      productoActual = _useState8[0],\n      setProductoActual = _useState8[1];\n  /** Set Precio de oferta */\n\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      winnerUser = _useState10[0],\n      setWinnerUser = _useState10[1];\n\n  var _useState11 = useState(0),\n      _useState12 = _slicedToArray(_useState11, 2),\n      winnerOferta = _useState12[0],\n      setWinnerOferta = _useState12[1];\n  /** Error form add oferta */\n\n\n  var _useState13 = useState(''),\n      _useState14 = _slicedToArray(_useState13, 2),\n      error_message = _useState14[0],\n      setErrorMessage = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      rows = _useState16[0],\n      setRows = _useState16[1];\n\n  var _useState17 = useState(undefined),\n      _useState18 = _slicedToArray(_useState17, 2),\n      valSubastaOferta = _useState18[0],\n      setValSubastaOferta = _useState18[1];\n\n  var _useState19 = useState({}),\n      _useState20 = _slicedToArray(_useState19, 2),\n      user = _useState20[0],\n      setUser = _useState20[1];\n\n  var _useToken = useToken(),\n      token = _useToken.token;\n\n  var _useState21 = useState(\"\"),\n      _useState22 = _slicedToArray(_useState21, 2),\n      fecha = _useState22[0],\n      setFecha = _useState22[1];\n\n  var _useState23 = useState(\"00\"),\n      _useState24 = _slicedToArray(_useState23, 2),\n      second = _useState24[0],\n      setSecond = _useState24[1];\n\n  var _useState25 = useState(\"00\"),\n      _useState26 = _slicedToArray(_useState25, 2),\n      minute = _useState26[0],\n      setMinute = _useState26[1];\n\n  var _useState27 = useState(false),\n      _useState28 = _slicedToArray(_useState27, 2),\n      startCount = _useState28[0],\n      setStartCount = _useState28[1];\n\n  var _useState29 = useState(false),\n      _useState30 = _slicedToArray(_useState29, 2),\n      subastaFinalizada = _useState30[0],\n      setSubastaFinalizada = _useState30[1];\n  /** Set Update */\n\n\n  var _useState31 = useState(false),\n      _useState32 = _slicedToArray(_useState31, 2),\n      update = _useState32[0],\n      setUpdate = _useState32[1];\n  /** Step producto */\n\n\n  var _useState33 = useState(),\n      _useState34 = _slicedToArray(_useState33, 2),\n      productoStep = _useState34[0],\n      setProductoStep = _useState34[1];\n  /** Controles de tiempo */\n\n\n  var _useState35 = useState(),\n      _useState36 = _slicedToArray(_useState35, 2),\n      inicio = _useState36[0],\n      setInicio = _useState36[1];\n\n  var _useState37 = useState(),\n      _useState38 = _slicedToArray(_useState37, 2),\n      duracion = _useState38[0],\n      setDuracion = _useState38[1];\n\n  var _useState39 = useState(),\n      _useState40 = _slicedToArray(_useState39, 2),\n      fin = _useState40[0],\n      setFin = _useState40[1];\n\n  useEffect(function () {\n    /** The Subasta */\n    getSubasta();\n    /** Get Producto en subasta */\n\n    getProductoEnSubasta();\n    /** Products from subasta */\n\n    getSubastaProductos();\n    /** Set Data for User */\n\n    getUser();\n    /** Get Test */\n\n    getTest();\n  }, []);\n\n  var getTest = function getTest() {\n    var format = \"YYYY-MM-DD HH:mm:ss\";\n    var now = moment();\n    console.log(now.format(format));\n  };\n  /** Hacer generica la funcion para reutilizarla en el proximo producto */\n\n\n  useEffect(function () {\n    if (duracion !== undefined && inicio !== undefined) {\n      var interval = setInterval(function () {\n        var _fecha = moment(inicio);\n\n        var actual = moment();\n        var tiempo_maximo = moment(inicio);\n        tiempo_maximo.add(duracion, 'minute');\n        var diferencia_tiempo_maximo = actual.diff(tiempo_maximo, 'minute');\n        var diferencia_t_m_seconds = actual.diff(tiempo_maximo, 'second'); //console.log(\"diferencia tiempo maximo \", diferencia_tiempo_maximo, \" \", diferencia_t_m_seconds);\n\n        if (diferencia_tiempo_maximo > 0 && diferencia_t_m_seconds > 0) {\n          // Llego tarde.\n          var _fecha2 = \"Ya ha finalizado este fragmento de subasta . . . \";\n          setFecha(_fecha2);\n          setStartCount(false);\n          clearInterval(interval);\n          return;\n        }\n\n        if (diferencia_tiempo_maximo == 0 && diferencia_t_m_seconds == 0) {\n          // quedo no tocar\n          var _fecha3 = \"El tiempo de subasta de este producto ha terminado . . . \";\n          setFecha(_fecha3);\n          clearInterval(interval);\n          setUpdate(true);\n          setStartCount(false);\n          return;\n        }\n\n        var diferencia = _fecha.diff(actual, 'minute');\n\n        var dif_seconds = _fecha.diff(actual, 'second');\n        /** Dentro de la subasta */\n\n\n        if (diferencia <= 0 && dif_seconds <= 0) {\n          var _fecha4 = \"Ha comenzado la subasta\";\n          setFecha(_fecha4);\n          console.log(\" --------- DENTRO DEL TIEMPO DE SUBASTA --------- \");\n          var min = diferencia_tiempo_maximo !== 0 ? diferencia_tiempo_maximo * -1 : diferencia_tiempo_maximo;\n          var segundo = diferencia_t_m_seconds !== 0 ? diferencia_t_m_seconds * -1 - min * 60 : diferencia_t_m_seconds;\n          setMinute(min);\n          setSecond(segundo);\n          setStartCount(true);\n          return;\n        }\n\n        if (diferencia >= 0 && dif_seconds > 0) {\n          // quedo ! no tocar\n          console.log(\"Comenzará en . . . \", diferencia, dif_seconds - diferencia * 60);\n\n          var _fecha5 = \"Comenzará en \" + diferencia + \" minutos \" + (dif_seconds - diferencia * 60) + \" segundos.\";\n\n          setFecha(_fecha5);\n        }\n      }, 1000);\n    }\n  }, [inicio, duracion]); // Se ejecuta cuando la variable fecha esta lista\n\n  /** Subasta Oferta Winn y Ofertas */\n\n  useEffect(function () {\n    if (startCount && productoEnSubastaActual) {\n      setInterval(function () {\n        getSubastaOfertaWinner();\n      }, 500);\n    }\n\n    getStreamSubastaOfertas();\n  }, [startCount, productoEnSubastaActual]);\n  /** Importante obtener el producto actual en subasta o si no setear el producto que debe subastarse */\n\n  useEffect(function () {\n    if (update) {\n      /** Actualiza el producto que se subasto */\n      setUpdateProductoEnSubasta();\n      /** Obtiene el producto que se tiene que subastar */\n\n      getProductoEnSubasta();\n      /** Products from subasta */\n\n      getSubastaProductos();\n      /** No cambiar producto hasta terminar la subasta actual */\n\n      setUpdate(false);\n      console.log(\"ACCTUALIZACION DE PRODUCTO PARA NUEVO COMIENZOE DE SUBASTA .........................\", productoEnSubastaActual);\n      /** Reiniciar conteo */\n\n      setStartCount(true);\n    }\n  }, [update]); // sin [] se ejecuta varias veces \n\n  /** Set producto actual en Stepper */\n\n  useEffect(function () {\n    if (update) {\n      var _orden = productoEnSubastaActual.orden;\n      setProductoStep(_orden);\n    }\n  }, [update]);\n  /** Get subasta oferta winner por ahora */\n\n  var getSubastaOfertaWinner = function getSubastaOfertaWinner() {\n    var request = new proto.SubastaProductoId();\n    request.setId(productoEnSubastaActual.id);\n    subastaService.getSubastaOfertaWinner(request, {}, function (error, response) {\n      //console.log(\"viene acá o no?\", request)\n      if (error) {\n        //setErrorMessage(error.message);\n        console.log(error);\n      } else {\n        var oferta_precio = response.getOfertaPrecio();\n\n        var _user = response.getUser();\n\n        if (winnerOferta < oferta_precio) {\n          setWinnerOferta(oferta_precio);\n          setWinnerUser(_user);\n        }\n      }\n    });\n  };\n  /** Get User info */\n\n\n  var getUser = function getUser() {\n    var token_decoded = jwt_decode(token);\n    var user = {\n      users_id: token_decoded.users_id,\n      name: token_decoded.name,\n      photo: token_decoded.profile_photo_path\n    };\n    setUser(user);\n  };\n\n  var getStreamSubastaOfertas = function getStreamSubastaOfertas() {\n    var request = new proto.SubastaProductoId();\n    request.setId(productoEnSubastaActual.id);\n    /** Ofertas de la subasta de un producto */\n\n    var stream = subastaService.getStreamSubastaOfertas(request, {});\n    stream.on('data', function (response) {\n      var record = {\n        user: response.getUser(),\n        oferta: response.getOfertaPrecio()\n      };\n      setRows(function (rows) {\n        return [].concat(_toConsumableArray(rows), [record]);\n      });\n    });\n    stream.on(\"status\", function (status) {\n      console.log(status.code, status.details, status.metadata);\n    });\n    stream.on(\"end\", function () {\n      console.log(\"Stream ended.\");\n    });\n    /* var stream_oferta_winner = subastaService.getStreamSubastaOfertaWinner(request, {});\n    stream_oferta_winner.on('data', function(response){\n        console.log(\"RESPUESTA GANADORA\", response.getOfertaPrecio())\n        setWinnerUser(response.getUser())\n        setWinnerOferta(response.getOfertaPrecio())\n    });\n     stream_oferta_winner.on(\"status\", function (status) {\n        console.log(status.code, status.details, status.metadata);\n      });\n           stream_oferta_winner.on(\"end\", () => {\n        console.log(\"Stream ended.\");\n    }); */\n  };\n\n  var getSubasta = function getSubasta() {\n    var request = new proto.SubastaId();\n    request.setId(id);\n    var metadata = {};\n    subastaService.getSubasta(request, metadata, function (err, response) {\n      if (err) {\n        console.log(err.code, err.message);\n      } else {\n        var _subasta = {\n          id: response.getId(),\n          subasta: response.getSubasta(),\n          fecha: response.getFecha(),\n          activo: response.getActivo(),\n          duracion: response.getDuracion(),\n          descanso: response.getDescanso(),\n          created_at: response.getCreatedAt(),\n          updated_at: response.getUpdatedAt()\n        };\n        setSubasta(_subasta);\n        setDuracion(response.getDuracion());\n      }\n    });\n  };\n\n  var getSubastaProductos = function getSubastaProductos() {\n    var request = new proto.SubastaId();\n    request.setId(id); // Id from param \n\n    var metadata = {};\n    subastaService.getSubastaProductos(request, metadata, function (err, response) {\n      if (err !== null) {\n        console.log(\"Error en get Subasta Productos \", err.code, err.message);\n        return;\n      } else {\n        var subastaProductosList = response.getSubastasProductosList();\n        subastaProductosList = subastaProductosList.map(function (subastaProducto) {\n          return {\n            id: subastaProducto.array[0],\n            producto: {\n              productos_id: subastaProducto.array[1][0],\n              producto: subastaProducto.array[1][1],\n              descripcion: subastaProducto.array[1][2],\n              stock: subastaProducto.array[1][3],\n              precio_inicial: subastaProducto.array[1][4],\n              precio_aumento: subastaProducto.array[1][5],\n              precio_subasta: subastaProducto.array[1][6],\n              cliente: {\n                cliente_id: subastaProducto.array[1][7][0],\n                cliente: subastaProducto.array[1][7][1],\n                cuit: subastaProducto.array[1][7][2],\n                direccion: subastaProducto.array[1][7][3],\n                ciudad: subastaProducto.array[1][7][4],\n                iva: subastaProducto.array[1][7][5]\n              }\n            },\n            activo: subastaProducto.array[2],\n            oferta_final: subastaProducto.array[3],\n            subastas_ofertas_id_winner: subastaProducto.array[4],\n            status: subastaProducto.array[5],\n            orden: subastaProducto.array[6],\n            inicio: subastaProducto.array[7]\n          };\n        });\n        setSubastaProductos(subastaProductosList);\n      }\n    });\n  };\n  /** Actualizar el producto en subasta una vez terminado */\n\n\n  var setUpdateProductoEnSubasta = function setUpdateProductoEnSubasta() {\n    /** Set oferta final y winner */\n    var request = new proto.SubastaProductoId();\n    request.setId(productoEnSubastaActual.id);\n    subastaService.getWinner(request, {}, function (error, response) {\n      //console.log(error, response)\n      if (error) {\n        setErrorMessage(error.message);\n        return;\n      }\n\n      setWinnerUser(response.getUser());\n      setWinnerOferta(response.getOfertaFinal());\n    });\n  };\n  /** Obtener el producto en subasta si ya existe --- de acuerdo al Id y Tiempo */\n\n\n  var getProductoEnSubasta = function getProductoEnSubasta() {\n    var format = \"YYYY-MM-DD HH:mm:ss\";\n    var now = moment();\n    now = now.format(format);\n    var request = new proto.SubastaIdTime();\n    request.setId(id); // id from params\n\n    request.setTime(now);\n    subastaService.getSubastaProductoEnSubasta(request, {}, function (error, response) {\n      if (!error) {\n        var subastaProducto = SetterSubastaProducto(response);\n        setProductoEnSubastaActual(subastaProducto);\n        setProductoActual(subastaProducto.producto);\n        setInicio(subastaProducto.inicio);\n        setDuracion(subasta.duracion);\n        /** Set Orden de producto */\n\n        setProductoStep(orden);\n      } else {\n        console.log(error);\n      }\n    });\n  };\n  /** Crear una Oferta para un producto en subasta */\n\n\n  var handlerCreateSubastaOferta = function handlerCreateSubastaOferta(e) {\n    e.preventDefault();\n    console.log(valSubastaOferta, productoActual.precio_inicial, productoEnSubastaActual.id);\n\n    if (isNaN(valSubastaOferta)) {\n      setErrorMessage('Ingresa un número valido.');\n      return;\n    }\n\n    if (valSubastaOferta < productoActual.precio_inicial + productoActual.precio_aumento) {\n      setErrorMessage('Debe ser superior al precio inicial: ' + productoActual.precio_inicial);\n      return;\n    }\n\n    var ofertaGanadora = winnerOferta;\n    console.log(\"Cual es la oferta ganadora actual: \", ofertaGanadora);\n\n    if (valSubastaOferta < ofertaGanadora + productoActual.precio_aumento) {\n      setErrorMessage('El valor de oferta debe ser superior a ' + (ofertaGanadora + productoActual.precio_aumento));\n      return;\n    }\n\n    var subastaOfertaCreate = new proto.SubastaOfertaCreate();\n    subastaOfertaCreate.setUsersId(user.users_id);\n    subastaOfertaCreate.setOfertaPrecio(valSubastaOferta);\n    subastaOfertaCreate.setSubastasProductosId(productoEnSubastaActual.id);\n    subastaService.addSubastaOferta(subastaOfertaCreate, {}, function (error, _) {\n      if (error !== null) {\n        console.log(error.code, error.message);\n      }\n\n      setErrorMessage(\"\");\n    });\n    setValSubastaOferta(undefined);\n    document.getElementById('valSubastaOferta').value = '';\n  };\n  /** Extrac subasta producto from request gRPC */\n\n\n  var SetterSubastaProducto = function SetterSubastaProducto(response) {\n    var subastaProducto = {\n      id: response.array[0],\n      producto: {\n        productos_id: response.array[1][0],\n        producto: response.array[1][1],\n        descripcion: response.array[1][2],\n        stock: response.array[1][3],\n        precio_inicial: response.array[1][4],\n        precio_aumento: response.array[1][5],\n        precio_subasta: response.array[1][6],\n        cliente: {\n          cliente_id: response.array[1][7][0],\n          cliente: response.array[1][7][1],\n          cuit: response.array[1][7][2],\n          direccion: response.array[1][7][3],\n          ciudad: response.array[1][7][4],\n          iva: response.array[1][7][5]\n        }\n      },\n      activo: response.array[2],\n      oferta_final: response.array[3],\n      subastas_ofertas_id_winner: response.array[4],\n      status: response.array[5],\n      orden: response.array[6],\n      inicio: response.array[7]\n    };\n    return subastaProducto;\n  };\n\n  return /*#__PURE__*/React.createElement(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      paddingTop: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 5,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      paddingBottom: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h1\",\n    fontSize: 40,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 33\n    }\n  }, subasta.subasta), /*#__PURE__*/React.createElement(Typography, {\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 33\n    }\n  }, \"Fecha y hora: \", subasta.fecha), Object.entries(productoEnSubastaActual).length > 0 && Object.entries(productoActual).length > 0 && /*#__PURE__*/React.createElement(Typography, {\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 133\n    }\n  }, \"Subastando producto desde: \", productoEnSubastaActual.inicio ? productoEnSubastaActual.inicio : subasta.fecha, \" / N\\xB0 producto: \", productoEnSubastaActual.orden, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 195\n    }\n  }), \"Subastando - \", productoActual.producto, \" / \", productoEnSubastaActual.status, \" / Unidades - \", productoActual.stock, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 147\n    }\n  }))), winnerOferta !== undefined && winnerUser !== undefined && !startCount && /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 103\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    paddingY: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 34\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    variant: \"outlined\",\n    severity: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 37\n    }\n  }, \"Ganador de \\xFAltima subasta: \", winnerUser, \" - $ \", winnerOferta))), startCount && /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 44\n    }\n  }, winnerOferta !== undefined && winnerUser !== undefined && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    paddingBottom: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 92\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    variant: \"outlined\",\n    severity: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 37\n    }\n  }, \"MEJOR OFERTA POR: \", winnerUser, \" - $ \", winnerOferta)), error_message !== '' && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    paddingBottom: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    severity: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 37\n    }\n  }, error_message)), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    inputProps: {\n      inputMode: 'numeric',\n      pattern: '[0-9]*'\n    },\n    style: {\n      height: '38px'\n    },\n    id: \"valSubastaOferta\",\n    onChange: function onChange(e) {\n      return setValSubastaOferta(e.target.value);\n    },\n    fullWidth: true,\n    label: \"Ofertar\",\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 494,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: handlerCreateSubastaOferta,\n    fullWidth: true,\n    variant: \"outlined\",\n    size: \"large\"\n    /* style={{ paddingTop: '13px', paddingBottom: '13px' }} */\n    ,\n    style: {\n      padding: '14px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 495,\n      columnNumber: 37\n    }\n  }, \"Ofertar\"))), startCount && /*#__PURE__*/React.createElement(DataGridSubastaOfertas, {\n    rows: rows,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 44\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 7,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      paddingBottom: '40px',\n      paddingTop: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 512,\n      columnNumber: 33\n    }\n  }, fecha), startCount && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    padding: 2,\n    sx: {\n      borderRadius: 1,\n      backgroundColor: '#e6e6e6',\n      margin: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 518,\n      columnNumber: 37\n    }\n  }, minute, \" : \", second))), productoStep && subastaProductos && /*#__PURE__*/React.createElement(StepperVertical, {\n    steps: subastaProductos,\n    actual: productoStep - 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 66\n    }\n  }))))));\n}","map":{"version":3,"sources":["/home/juan/node_projects/js-client-grpc-web/src/Subastas/JoinSubasta.js"],"names":["React","useEffect","useState","useParams","Alert","Box","Button","Container","Grid","TextField","Typography","proto","DataGridSubastaOfertas","Layout","useToken","jwt_decode","StepperVertical","moment","subastaService","SubastaServiceClient","JoinSubasta","id","subasta","setSubasta","subastaProductos","setSubastaProductos","productoEnSubastaActual","setProductoEnSubastaActual","productoActual","setProductoActual","winnerUser","setWinnerUser","winnerOferta","setWinnerOferta","error_message","setErrorMessage","rows","setRows","undefined","valSubastaOferta","setValSubastaOferta","user","setUser","token","fecha","setFecha","second","setSecond","minute","setMinute","startCount","setStartCount","subastaFinalizada","setSubastaFinalizada","update","setUpdate","productoStep","setProductoStep","inicio","setInicio","duracion","setDuracion","fin","setFin","getSubasta","getProductoEnSubasta","getSubastaProductos","getUser","getTest","format","now","console","log","interval","setInterval","_fecha","actual","tiempo_maximo","add","diferencia_tiempo_maximo","diff","diferencia_t_m_seconds","clearInterval","diferencia","dif_seconds","min","segundo","getSubastaOfertaWinner","getStreamSubastaOfertas","setUpdateProductoEnSubasta","orden","request","SubastaProductoId","setId","error","response","oferta_precio","getOfertaPrecio","token_decoded","users_id","name","photo","profile_photo_path","stream","on","record","oferta","status","code","details","metadata","SubastaId","err","message","getId","getFecha","activo","getActivo","getDuracion","descanso","getDescanso","created_at","getCreatedAt","updated_at","getUpdatedAt","subastaProductosList","getSubastasProductosList","map","subastaProducto","array","producto","productos_id","descripcion","stock","precio_inicial","precio_aumento","precio_subasta","cliente","cliente_id","cuit","direccion","ciudad","iva","oferta_final","subastas_ofertas_id_winner","getWinner","getOfertaFinal","SubastaIdTime","setTime","getSubastaProductoEnSubasta","SetterSubastaProducto","handlerCreateSubastaOferta","e","preventDefault","isNaN","ofertaGanadora","subastaOfertaCreate","SubastaOfertaCreate","setUsersId","setOfertaPrecio","setSubastasProductosId","addSubastaOferta","_","document","getElementById","value","paddingTop","paddingBottom","Object","entries","length","inputMode","pattern","height","target","padding","display","justifyContent","width","borderRadius","backgroundColor","margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { Alert, Box, Button, Container, Grid, TextField, Typography } from '@mui/material';\nimport proto from '../pb/proto_grpc_web_pb';\nimport DataGridSubastaOfertas from '../components/DataGridTable';\nimport Layout from '../components/Layout/Layout';\nimport useToken from '../App/useToken';\nimport jwt_decode from 'jwt-decode';\nimport StepperVertical from '../components/StepperVertical';\nimport moment from 'moment';\n\n\n/** My Client gRPC - to Golang gRPC Server */\nvar subastaService = new proto.SubastaServiceClient('http://0.0.0.0:8000');\n\n\nexport default function JoinSubasta(){\n    const { id } = useParams();\n\n    /** Info Subasta */\n    const [subasta, setSubasta] = useState({});\n\n    /** Lista de productos en subasta */\n    const [subastaProductos, setSubastaProductos] = useState([]);\n\n    /** Producto actual en Subasta */\n    const [productoEnSubastaActual, setProductoEnSubastaActual] = useState([]);\n\n    /** Producto subasta */\n    const [productoActual, setProductoActual] = useState([]);\n    \n    /** Set Precio de oferta */\n    const [winnerUser, setWinnerUser] = useState();\n    const [winnerOferta, setWinnerOferta] = useState(0);\n\n    /** Error form add oferta */\n    const [error_message, setErrorMessage] = useState('')\n    const [rows, setRows] = useState([]);\n    const [valSubastaOferta, setValSubastaOferta] = useState(undefined);\n    const [user, setUser] = useState({});\n    const { token } = useToken();\n    const [fecha, setFecha] = useState(\"\");\n    const [second, setSecond] = useState(\"00\");\n    const [minute, setMinute] = useState(\"00\");\n    const [startCount, setStartCount] = useState(false);\n    const [subastaFinalizada, setSubastaFinalizada] = useState(false);\n\n    /** Set Update */\n    const [update, setUpdate] = useState(false);\n    \n    /** Step producto */\n    const [productoStep, setProductoStep] = useState();\n\n    /** Controles de tiempo */\n    const [inicio, setInicio] = useState();\n    const [duracion, setDuracion] = useState();\n    const [fin, setFin] = useState();\n\n    useEffect(() => {\n        /** The Subasta */\n        getSubasta();\n\n        /** Get Producto en subasta */\n        getProductoEnSubasta();\n\n        /** Products from subasta */        \n        getSubastaProductos();\n\n        /** Set Data for User */\n        getUser();\n\n        /** Get Test */\n        getTest();\n    }, [])\n\n    const getTest = () => {\n        const format = \"YYYY-MM-DD HH:mm:ss\"\n        let now = moment()\n        console.log(now.format(format));\n    }\n\n    /** Hacer generica la funcion para reutilizarla en el proximo producto */\n    useEffect(() => {\n        if(duracion !== undefined && inicio !== undefined){\n            let interval = setInterval(() => {\n                let _fecha = moment(inicio)\n                let actual = moment();\n                let tiempo_maximo = moment(inicio);\n                tiempo_maximo.add(duracion, 'minute');\n\n                let diferencia_tiempo_maximo = actual.diff(tiempo_maximo, 'minute');\n                let diferencia_t_m_seconds = actual.diff(tiempo_maximo, 'second');\n                \n                //console.log(\"diferencia tiempo maximo \", diferencia_tiempo_maximo, \" \", diferencia_t_m_seconds);\n                if(diferencia_tiempo_maximo > 0 && diferencia_t_m_seconds > 0){ // Llego tarde.\n                    let fecha = \"Ya ha finalizado este fragmento de subasta . . . \"\n                    setFecha(fecha);\n                    \n                    setStartCount(false);\n                    clearInterval(interval)\n                    return ;\n                }\n\n                if(diferencia_tiempo_maximo == 0 && diferencia_t_m_seconds == 0){ // quedo no tocar\n                    let fecha = \"El tiempo de subasta de este producto ha terminado . . . \"\n                    setFecha(fecha);\n\n                    clearInterval(interval);\n                    setUpdate(true);\n                    setStartCount(false);\n                    return ;\n                }\n\n                var diferencia = _fecha.diff(actual, 'minute');\n                var dif_seconds = _fecha.diff(actual, 'second');\n\n                /** Dentro de la subasta */\n                if (diferencia <= 0 && dif_seconds <= 0){\n                    let fecha = \"Ha comenzado la subasta\";\n                    setFecha(fecha);\n                    console.log(\" --------- DENTRO DEL TIEMPO DE SUBASTA --------- \");\n                    let min = (diferencia_tiempo_maximo !== 0) ? (diferencia_tiempo_maximo*-1) : diferencia_tiempo_maximo;\n                    let segundo = (diferencia_t_m_seconds !== 0) ? ((diferencia_t_m_seconds*-1)-(min*60)) : diferencia_t_m_seconds;\n\n                    setMinute(min);\n                    setSecond(segundo);\n                    setStartCount(true);\n\n                    return ;\n                }\n\n                if(diferencia >= 0 && dif_seconds > 0){ // quedo ! no tocar\n                    console.log(\"Comenzará en . . . \", diferencia,  dif_seconds-(diferencia*60))\n                    let fecha = \"Comenzará en \"+ diferencia + \" minutos \" + (dif_seconds-(diferencia*60)) + \" segundos.\";\n                    setFecha(fecha)\n                }\n            }, 1000)\n        }\n    }, [inicio, duracion]) // Se ejecuta cuando la variable fecha esta lista\n\n    /** Subasta Oferta Winn y Ofertas */\n    useEffect(() => {\n        if(startCount && productoEnSubastaActual){\n            setInterval(() => {\n                getSubastaOfertaWinner(); \n            }, 500)\n        }\n        getStreamSubastaOfertas();\n    }, [startCount, productoEnSubastaActual])\n\n    /** Importante obtener el producto actual en subasta o si no setear el producto que debe subastarse */\n    useEffect(() => {\n        if(update){\n            /** Actualiza el producto que se subasto */\n            setUpdateProductoEnSubasta();\n\n            /** Obtiene el producto que se tiene que subastar */\n            getProductoEnSubasta();\n\n            /** Products from subasta */        \n            getSubastaProductos();\n\n            /** No cambiar producto hasta terminar la subasta actual */\n            setUpdate(false);\n\n            console.log(\"ACCTUALIZACION DE PRODUCTO PARA NUEVO COMIENZOE DE SUBASTA .........................\", productoEnSubastaActual)\n\n            /** Reiniciar conteo */\n            setStartCount(true);\n        }\n    }, [update]) // sin [] se ejecuta varias veces \n\n    /** Set producto actual en Stepper */\n    useEffect(() => {\n        if(update){\n            let orden = productoEnSubastaActual.orden;\n            setProductoStep(orden);\n        }\n    }, [update]);\n\n    /** Get subasta oferta winner por ahora */\n    const getSubastaOfertaWinner = () => {\n        let request = new proto.SubastaProductoId();\n        request.setId(productoEnSubastaActual.id);\n        subastaService.getSubastaOfertaWinner(request, {}, (error, response) => {\n            //console.log(\"viene acá o no?\", request)\n            if(error){\n                //setErrorMessage(error.message);\n                console.log(error)\n            }else{\n                let oferta_precio = response.getOfertaPrecio();\n                let user = response.getUser();\n\n                if(winnerOferta < oferta_precio){\n                    setWinnerOferta(oferta_precio);\n                    setWinnerUser(user);\n                }\n            }\n        })\n    } \n\n    /** Get User info */\n    const getUser = () => {\n        var token_decoded = jwt_decode(token);\n        let user = {\n            users_id: token_decoded.users_id,\n            name: token_decoded.name,\n            photo: token_decoded.profile_photo_path,\n        }\n        setUser(user);\n    }\n\n    const getStreamSubastaOfertas = () => {\n        let request = new proto.SubastaProductoId();\n        request.setId(productoEnSubastaActual.id)\n\n        /** Ofertas de la subasta de un producto */\n        var stream = subastaService.getStreamSubastaOfertas(request, {});\n        stream.on('data', function(response){\n            let record = {\n                user: response.getUser(),\n                oferta: response.getOfertaPrecio()\n            };   \n\n            setRows((rows) => [...rows, record])\n        })\n        stream.on(\"status\", function (status) {\n            console.log(status.code, status.details, status.metadata);\n          });\n      \n        stream.on(\"end\", () => {\n            console.log(\"Stream ended.\");\n        });\n\n        \n        /* var stream_oferta_winner = subastaService.getStreamSubastaOfertaWinner(request, {});\n        stream_oferta_winner.on('data', function(response){\n            console.log(\"RESPUESTA GANADORA\", response.getOfertaPrecio())\n            setWinnerUser(response.getUser())\n            setWinnerOferta(response.getOfertaPrecio())\n        });\n\n        stream_oferta_winner.on(\"status\", function (status) {\n            console.log(status.code, status.details, status.metadata);\n          });\n      \n        stream_oferta_winner.on(\"end\", () => {\n            console.log(\"Stream ended.\");\n        }); */\n\n    };\n\n    const getSubasta = () => {\n        var request = new proto.SubastaId();\n        request.setId(id)\n        var metadata = {};\n    \n        subastaService.getSubasta(request, metadata, (err, response) => {\n            if (err) {\n                console.log(err.code, err.message);\n            } else {\n                let subasta = {\n                    id: response.getId(),\n                    subasta: response.getSubasta(),\n                    fecha: response.getFecha(),\n                    activo: response.getActivo(),\n                    duracion: response.getDuracion(),\n                    descanso: response.getDescanso(),\n                    created_at: response.getCreatedAt(),\n                    updated_at: response.getUpdatedAt()\n                }\n\n                setSubasta(subasta);\n                setDuracion(response.getDuracion());\n            }\n        });\n    }\n\n    const getSubastaProductos = () => {\n        var request = new proto.SubastaId()\n        request.setId(id) // Id from param \n        var metadata = {}\n\n        subastaService.getSubastaProductos(request, metadata, (err, response) => {\n            if(err !== null){\n                console.log(\"Error en get Subasta Productos \", err.code, err.message)\n                return ;\n            }else{\n                let subastaProductosList = response.getSubastasProductosList();\n                subastaProductosList = subastaProductosList\n                    .map((subastaProducto) => {\n                        return {\n                            id: subastaProducto.array[0],\n                            producto: {\n                                productos_id: subastaProducto.array[1][0],\n                                producto: subastaProducto.array[1][1],\n                                descripcion: subastaProducto.array[1][2],\n                                stock: subastaProducto.array[1][3],\n                                precio_inicial: subastaProducto.array[1][4],\n                                precio_aumento: subastaProducto.array[1][5],\n                                precio_subasta: subastaProducto.array[1][6],\n                                cliente: {\n                                    cliente_id: subastaProducto.array[1][7][0],\n                                    cliente: subastaProducto.array[1][7][1],\n                                    cuit: subastaProducto.array[1][7][2],\n                                    direccion: subastaProducto.array[1][7][3],\n                                    ciudad: subastaProducto.array[1][7][4],\n                                    iva: subastaProducto.array[1][7][5],\n                                },\n                            },\n                            activo: subastaProducto.array[2],\n                            oferta_final: subastaProducto.array[3],\n                            subastas_ofertas_id_winner: subastaProducto.array[4],\n                            status: subastaProducto.array[5],\n                            orden: subastaProducto.array[6],\n                            inicio: subastaProducto.array[7],\n                        }\n                    })\n                setSubastaProductos(subastaProductosList);\n            }\n        });\n    }\n\n    /** Actualizar el producto en subasta una vez terminado */\n    const setUpdateProductoEnSubasta = () => {\n        /** Set oferta final y winner */\n        let request = new proto.SubastaProductoId();\n        request.setId(productoEnSubastaActual.id)\n        subastaService.getWinner(request, {}, (error, response) => {\n            //console.log(error, response)\n            if(error){\n                setErrorMessage(error.message)\n                return ;\n            }\n            setWinnerUser(response.getUser())\n            setWinnerOferta(response.getOfertaFinal());\n        });\n    }\n\n    \n\n    /** Obtener el producto en subasta si ya existe --- de acuerdo al Id y Tiempo */\n    const getProductoEnSubasta = () => {\n        let format = \"YYYY-MM-DD HH:mm:ss\"\n        let now = moment()\n        now = now.format(format);\n        let request = new proto.SubastaIdTime()\n        request.setId(id) // id from params\n        request.setTime(now)\n\n        subastaService.getSubastaProductoEnSubasta(request, {}, (error, response) => {\n            if(!error){\n                let subastaProducto = SetterSubastaProducto(response)            \n                setProductoEnSubastaActual(subastaProducto);\n                setProductoActual(subastaProducto.producto)\n\n                setInicio(subastaProducto.inicio);\n                setDuracion(subasta.duracion);\n\n                /** Set Orden de producto */\n                setProductoStep(orden);\n\n            }else{\n                console.log(error)\n            }\n        })\n    }\n\n\n    /** Crear una Oferta para un producto en subasta */\n    const handlerCreateSubastaOferta = (e) => {\n        e.preventDefault();\n        console.log(valSubastaOferta, productoActual.precio_inicial, productoEnSubastaActual.id);\n\n        if(isNaN(valSubastaOferta)){\n            setErrorMessage('Ingresa un número valido.');\n            return ;\n        }\n\n        if(valSubastaOferta < (productoActual.precio_inicial+productoActual.precio_aumento)){\n            setErrorMessage('Debe ser superior al precio inicial: '+productoActual.precio_inicial);\n            return ;\n        }\n        let ofertaGanadora = winnerOferta;\n\n        console.log(\"Cual es la oferta ganadora actual: \", ofertaGanadora)\n        if(valSubastaOferta < (ofertaGanadora+productoActual.precio_aumento)){\n            setErrorMessage('El valor de oferta debe ser superior a '+ (ofertaGanadora+productoActual.precio_aumento));\n            return ;\n        } \n\n        let subastaOfertaCreate = new proto.SubastaOfertaCreate();\n        subastaOfertaCreate.setUsersId(user.users_id);\n        subastaOfertaCreate.setOfertaPrecio(valSubastaOferta);\n        subastaOfertaCreate.setSubastasProductosId(productoEnSubastaActual.id);\n\n        subastaService.addSubastaOferta(subastaOfertaCreate, {}, (error, _) => {\n            if(error !== null) {\n                console.log(error.code, error.message)\n            }\n            setErrorMessage(\"\");\n        });\n\n        setValSubastaOferta(undefined)\n        document.getElementById('valSubastaOferta').value = '';\n    }\n\n\n    /** Extrac subasta producto from request gRPC */\n    const SetterSubastaProducto = (response) => {\n        let subastaProducto = {\n            id: response.array[0],\n            producto: {\n                productos_id: response.array[1][0],\n                producto: response.array[1][1],\n                descripcion: response.array[1][2],\n                stock: response.array[1][3],\n                precio_inicial: response.array[1][4],\n                precio_aumento: response.array[1][5],\n                precio_subasta: response.array[1][6],\n                cliente: {\n                    cliente_id: response.array[1][7][0],\n                    cliente: response.array[1][7][1],\n                    cuit: response.array[1][7][2],\n                    direccion: response.array[1][7][3],\n                    ciudad: response.array[1][7][4],\n                    iva: response.array[1][7][5],\n                },\n            },\n            activo: response.array[2],\n            oferta_final: response.array[3],\n            subastas_ofertas_id_winner: response.array[4],\n            status: response.array[5],\n            orden: response.array[6],\n            inicio: response.array[7],\n        };\n\n        return subastaProducto;\n    }\n\n    return (\n        <Layout>\n            <Box sx={{ paddingTop: 8 }}>\n                <Container>\n                    <Grid container spacing={5}>\n                        <Grid item xs={5} align=\"left\">      \n                            <Box style={{ paddingBottom: '20px' }}>\n                                <Typography variant=\"h1\" fontSize={40}>\n                                    {subasta.subasta}\n                                </Typography> \n                                <Typography fontSize=\"small\">\n                                    Fecha y hora: {subasta.fecha}\n                                </Typography>\n\n\n                                {Object.entries(productoEnSubastaActual).length > 0 && Object.entries(productoActual).length > 0 && <Typography fontSize=\"small\">\n                                    Subastando producto desde: {(productoEnSubastaActual.inicio) ? productoEnSubastaActual.inicio : subasta.fecha} / N° producto: {productoEnSubastaActual.orden} <br></br>\n                                    Subastando - {productoActual.producto} / {productoEnSubastaActual.status} / Unidades - {productoActual.stock} <br></br>  \n                                </Typography>}\n                            </Box>\n\n                            {winnerOferta !== undefined && winnerUser !== undefined && !startCount && <Grid container>   \n                                 <Grid item xs={12} paddingY={4}>\n                                    <Alert  variant=\"outlined\" severity=\"success\">\n                                        Ganador de última subasta: {winnerUser} - $ { winnerOferta }\n                                    </Alert>\n                                </Grid>\n                            </Grid>}\n\n                            {startCount && <Grid container>   \n                                {winnerOferta !== undefined && winnerUser !== undefined && <Grid item xs={12} paddingBottom={4}>\n                                    <Alert  variant=\"outlined\" severity=\"success\">\n                                        MEJOR OFERTA POR: {winnerUser} - $ { winnerOferta }\n                                    </Alert>\n                                </Grid>}\n\n\n                                {error_message !== '' &&\n                                <Grid item xs={12} paddingBottom={4}> \n                                    <Alert severity=\"error\">{ error_message }</Alert>  \n                                </Grid>}\n\n                                <Grid item xs={8}>\n                                    <TextField \n                                        inputProps={{ inputMode: 'numeric', pattern: '[0-9]*'  }}\n                                        style={{ height:'38px' }}\n                                        id=\"valSubastaOferta\" \n                                        onChange={(e) => setValSubastaOferta(e.target.value)} \n                                        fullWidth \n                                        label=\"Ofertar\" \n                                        variant=\"outlined\" \n                                    />\n                                </Grid>\n                                <Grid item xs={4}>\n                                    <Button onClick={handlerCreateSubastaOferta} fullWidth variant=\"outlined\" size=\"large\" \n                                        /* style={{ paddingTop: '13px', paddingBottom: '13px' }} */\n                                        style={{ padding:'14px' }}\n                                    >\n                                        Ofertar\n                                    </Button>\n                                </Grid>\n                            </Grid>}\n\n\n                            {startCount && <DataGridSubastaOfertas rows={rows} />}\n                            \n                        </Grid>\n\n                        <Grid item xs={7}>  \n                                \n                            <Box style={{ paddingBottom: '40px', paddingTop: '20px' }}>\n                                <Typography align='center'>\n                                    {fecha} \n                                </Typography>\n                                \n                                {startCount && \n                                <div style={{ display:'flex', justifyContent:'center', width:'100%' }}>\n                                    <Box padding={2} sx={{ borderRadius: 1, backgroundColor: '#e6e6e6', margin: 1 }}>\n                                        {minute} : {second} \n                                    </Box>\n                                </div>}\n\n                            </Box>\n                            {productoStep && subastaProductos && <StepperVertical steps={subastaProductos} actual={productoStep-1} />}\n                        </Grid>\n                    </Grid>\n\n                         \n                </Container>\n            </Box>\n        </Layout>\n    )\n}\n\n\n"]},"metadata":{},"sourceType":"module"}